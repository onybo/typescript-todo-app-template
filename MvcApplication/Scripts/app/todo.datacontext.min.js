var Todo;(function(n){var t=function(){function t(){}return t.prototype.getTodoLists=function(n,t){function r(t){var r=$.map(t,function(n){return i.createTodoList(n)});n(r)}function u(){t("Error retrieving todo lists.")}var i=this;return this.ajaxRequest("get",this.todoListUrl()).done(r).fail(u)},t.prototype.createTodoItem=function(t){return new n.Model.TodoItem(this,t)},t.prototype.createTodoList=function(t){return new n.Model.TodoList(this,t)},t.prototype.saveNewTodoItem=function(n){return this.clearErrorMessage(n),this.ajaxRequest("post",this.todoItemUrl(),n).done(function(t){n.TodoItemId=t.TodoItemId}).fail(function(){n.ErrorMessage("Error adding a new todo item.")})},t.prototype.saveNewTodoList=function(n){return this.clearErrorMessage(n),this.ajaxRequest("post",this.todoListUrl(),n).done(function(t){n.TodoListId=t.TodoListId,n.UserId=t.UserId}).fail(function(){n.ErrorMessage("Error adding a new todo list.")})},t.prototype.deleteTodoItem=function(n){return this.ajaxRequest("delete",this.todoItemUrl(n.TodoItemId)).fail(function(){n.ErrorMessage("Error removing todo item.")})},t.prototype.deleteTodoList=function(n){return this.ajaxRequest("delete",this.todoListUrl(n.TodoListId)).fail(function(){n.ErrorMessage("Error removing todo list.")})},t.prototype.saveChangedTodoItem=function(n){return this.clearErrorMessage(n),this.ajaxRequest("put",this.todoItemUrl(n.TodoItemId),n).fail(function(t,i){n.ErrorMessage("Error updating todo item."+i)})},t.prototype.saveChangedTodoList=function(n){return this.clearErrorMessage(n),this.ajaxRequest("put",this.todoListUrl(n.TodoListId),n).fail(function(t,i){n.ErrorMessage("Error updating the todo list title. Please make sure it is non-empty."+i)})},t.prototype.clearErrorMessage=function(n){n.ErrorMessage!=null&&n.ErrorMessage(null)},t.prototype.ajaxRequest=function(n,t,i){var r={dataType:"json",contentType:"application/json",cache:!1,type:n,data:ko.toJSON(i)};return $.ajax(t,r)},t.prototype.todoListUrl=function(n){return"/api/todolist/"+(n||"")},t.prototype.todoItemUrl=function(n){return"/api/todo/"+(n||"")},t}();n.Datacontext=t})(Todo||(Todo={}))